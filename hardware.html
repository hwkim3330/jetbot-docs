<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardware Guide - JetBot ROS2</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🤖</text></svg>">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <a href="index.html" class="logo">
                <span class="logo-icon">🤖</span>
                <span>JetBot ROS2</span>
            </a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="hardware.html" class="active">Hardware</a></li>
                <li><a href="software.html">Software</a></li>
                <li><a href="ros2.html">ROS2</a></li>
                <li><a href="reference.html">Reference</a></li>
            </ul>
            <a href="https://github.com/hwkim3330/jetbot-docs" class="nav-github" target="_blank">
                <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                GitHub
            </a>
        </div>
    </nav>

    <main class="main-content">
        <div class="doc-layout">
            <aside class="doc-sidebar">
                <h4>개요</h4>
                <ul>
                    <li><a href="#intro" class="active">하드웨어 설계 개요</a></li>
                    <li><a href="#architecture">시스템 아키텍처</a></li>
                </ul>
                <h4>전원 시스템</h4>
                <ul>
                    <li><a href="#power">전원 분배 네트워크</a></li>
                    <li><a href="#battery">배터리 선정</a></li>
                    <li><a href="#brownout">브라운아웃 방지</a></li>
                    <li><a href="#noise">노이즈 격리</a></li>
                </ul>
                <h4>인터페이스</h4>
                <ul>
                    <li><a href="#gpio">GPIO 전압 레벨</a></li>
                    <li><a href="#level-shifter">레벨 시프터</a></li>
                    <li><a href="#camera">카메라 인터페이스</a></li>
                    <li><a href="#i2c">I2C 버스 설정</a></li>
                </ul>
                <h4 id="parts">부품 목록</h4>
                <ul>
                    <li><a href="#bom">BOM (Bill of Materials)</a></li>
                    <li><a href="#motor">모터 드라이버</a></li>
                    <li><a href="#lidar">LiDAR 센서</a></li>
                </ul>
            </aside>

            <article class="doc-content">
                <div class="breadcrumb">
                    <a href="index.html">Home</a> / <span>Hardware Guide</span>
                </div>

                <h1 id="intro">하드웨어 설계 가이드</h1>
                <p>
                    Jetson Orin Nano 기반 JetBot의 하드웨어 설계는 기존 Jetson Nano와 근본적으로 다릅니다.
                    이 문서에서는 전원 시스템, GPIO 인터페이스, 센서 연결 등 하드웨어 통합의 모든 측면을 다룹니다.
                </p>

                <div class="alert alert-danger">
                    <strong>⚠️ 주의:</strong> Orin Nano의 GPIO는 <strong>엄격하게 3.3V</strong>만 허용합니다.
                    5V 신호를 직접 연결하면 보드가 영구적으로 손상될 수 있습니다!
                </div>

                <h2 id="architecture">시스템 아키텍처</h2>
                <p>JetBot의 전체 시스템 구성은 다음과 같습니다:</p>

                <div class="diagram">
┌─────────────────────────────────────────────────────────────────┐
│                        JETBOT SYSTEM                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────┐      ┌──────────────────────────────────┐    │
│   │   3S/4S     │      │      JETSON ORIN NANO            │    │
│   │   LiPo      │      │   ┌────────────────────────┐     │    │
│   │  Battery    │──────│───│  DC Barrel Jack (9-20V)│     │    │
│   │ (11.1-14.8V)│      │   └────────────────────────┘     │    │
│   └──────┬──────┘      │                                  │    │
│          │             │   ┌────────────────────────┐     │    │
│          │             │   │  40-Pin GPIO Header   │     │    │
│          │             │   │  • I2C (Bus 7)        │     │    │
│   ┌──────▼──────┐      │   │  • 3.3V Logic Only!   │     │    │
│   │   5V UBEC   │      │   └──────────┬───────────┘     │    │
│   │   (3-5A)    │      │              │                  │    │
│   └──────┬──────┘      │   ┌──────────▼───────────┐     │    │
│          │             │   │   CSI Camera (22pin)  │     │    │
│          │             │   │   IMX219 / IMX477     │     │    │
│          │             │   └──────────────────────┘     │    │
│          │             └──────────────────────────────────┘    │
│          │                                                      │
│   ┌──────▼──────────────────────────────────────────────┐      │
│   │                  5V POWER RAIL                       │      │
│   ├──────────────────────────────────────────────────────┤      │
│   │                                                      │      │
│   │   ┌─────────────┐    ┌─────────────┐                │      │
│   │   │  RPLIDAR    │    │  Level      │                │      │
│   │   │  A1/A2      │    │  Shifter    │                │      │
│   │   │  (USB)      │    │  (3.3V↔5V) │                │      │
│   │   └─────────────┘    └──────┬──────┘                │      │
│   │                             │                        │      │
│   │   ┌─────────────────────────▼─────────────────┐     │      │
│   │   │         MOTOR DRIVER BOARD                │     │      │
│   │   │  ┌─────────────┐    ┌─────────────┐      │     │      │
│   │   │  │  PCA9685    │    │  TB6612FNG  │      │     │      │
│   │   │  │  (I2C PWM)  │───▶│  (H-Bridge) │      │     │      │
│   │   │  └─────────────┘    └──────┬──────┘      │     │      │
│   │   └────────────────────────────┼──────────────┘     │      │
│   │                                │                     │      │
│   └────────────────────────────────┼─────────────────────┘      │
│                                    │                            │
│   ┌────────────────────────────────▼────────────────────┐      │
│   │                    DC MOTORS                         │      │
│   │         ┌───────┐              ┌───────┐            │      │
│   │         │ LEFT  │              │ RIGHT │            │      │
│   │         │ MOTOR │              │ MOTOR │            │      │
│   │         └───────┘              └───────┘            │      │
│   └──────────────────────────────────────────────────────┘      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                </div>

                <h2 id="power">전원 분배 네트워크 (PDN) 설계</h2>
                <p>
                    자율주행 로봇의 안정성은 전원 시스템의 신뢰성에 달려 있습니다.
                    Jetson Orin Nano는 고성능 컴퓨팅 모듈로, 부팅 시와 고부하 작업 시 상당한 전력을 소모합니다.
                </p>

                <div class="alert alert-warning">
                    <strong>⚡ 중요:</strong> 기존 JetBot에서 사용하던 USB 보조 배터리(5V 2A~3A)는
                    Orin Nano 시스템에 <strong>부적합</strong>합니다!
                </div>

                <h3 id="battery">전력 소모 프로파일</h3>
                <table>
                    <thead>
                        <tr>
                            <th>컴포넌트</th>
                            <th>일반 소모</th>
                            <th>피크 소모</th>
                            <th>비고</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jetson Orin Nano</td>
                            <td>7W</td>
                            <td>15W</td>
                            <td>GPU/CPU 풀로드 시</td>
                        </tr>
                        <tr>
                            <td>DC 모터 (2개)</td>
                            <td>2W</td>
                            <td>12W+</td>
                            <td>기동 시 개당 2~3A 돌입 전류</td>
                        </tr>
                        <tr>
                            <td>RPLIDAR A1/A2</td>
                            <td>1.5W</td>
                            <td>2W</td>
                            <td>5V 구동</td>
                        </tr>
                        <tr>
                            <td>카메라 + WiFi</td>
                            <td>2W</td>
                            <td>3W</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td><strong>전체 시스템</strong></td>
                            <td><strong>~15W</strong></td>
                            <td><strong>40W+</strong></td>
                            <td>피크 시 고려 필수</td>
                        </tr>
                    </tbody>
                </table>

                <h3>배터리 선정 가이드</h3>
                <table>
                    <thead>
                        <tr>
                            <th>사양</th>
                            <th>권장값</th>
                            <th>이유</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>배터리 유형</td>
                            <td>3S 또는 4S LiPo</td>
                            <td>9V~20V 입력 범위 충족</td>
                        </tr>
                        <tr>
                            <td>용량</td>
                            <td>2200mAh 이상</td>
                            <td>최소 30분 이상 구동</td>
                        </tr>
                        <tr>
                            <td>방전률 (C-rating)</td>
                            <td>30C 이상</td>
                            <td>모터 돌입 전류 대응</td>
                        </tr>
                        <tr>
                            <td>전압 범위</td>
                            <td>11.1V~16.8V</td>
                            <td>Orin Nano DC 잭 규격</td>
                        </tr>
                    </tbody>
                </table>

                <h3 id="brownout">브라운아웃(Brownout) 방지</h3>
                <p>
                    모터가 급격하게 전류를 끌어당길 때 배터리 전압이 임계값(약 4.75V) 이하로
                    떨어지면 시스템이 즉시 셧다운되는 브라운아웃 현상이 발생합니다.
                </p>

                <div class="alert alert-info">
                    <strong>💡 권장 전원 구성:</strong>
                    <ul>
                        <li><strong>Jetson 전원:</strong> 3S/4S LiPo → DC 배럴 잭(5.5x2.5mm) 직결 또는 DC-DC 컨버터 경유</li>
                        <li><strong>5V 레일:</strong> 별도 고출력(3~5A) 강압 컨버터(UBEC) 사용</li>
                        <li><strong>모터 전원:</strong> 배터리에서 별도 분기</li>
                    </ul>
                </div>

                <h3 id="noise">노이즈 격리 및 접지 전략</h3>
                <p>DC 모터는 브러시 스파크로 인해 심각한 전자기 간섭(EMI)을 발생시킵니다:</p>
                <ul>
                    <li><strong>스타 그라운드:</strong> 모든 접지선이 배터리 단자 한 지점에서 만나도록 배선</li>
                    <li><strong>세라믹 커패시터:</strong> 모터 단자에 0.1uF 병렬 연결 (고주파 노이즈 바이패스)</li>
                    <li><strong>전해 커패시터:</strong> 전원 라인에 470uF 이상 추가 (전압 리플 완화)</li>
                </ul>

                <h2 id="gpio">GPIO 전압 레벨 주의사항</h2>
                <p>
                    Orin Nano의 GPIO 헤더는 <strong>엄격하게 3.3V CMOS 로직</strong>을 따릅니다.
                    많은 로보틱스 부품이 5V TTL 레벨을 사용하므로 주의가 필요합니다.
                </p>

                <div class="alert alert-danger">
                    <strong>🚨 위험:</strong> 5V 출력 센서의 데이터 라인을 Orin Nano GPIO에 직접 연결하면
                    <strong>보드가 영구 손상</strong>될 수 있습니다!
                </div>

                <h3 id="level-shifter">레벨 시프터 사용</h3>
                <p>3.3V와 5V 시스템 간 통신을 위해 양방향 로직 레벨 시프터가 필수입니다:</p>
                <ul>
                    <li><strong>TXB0108:</strong> 8채널 양방향 레벨 시프터</li>
                    <li><strong>BSS138 기반 모듈:</strong> I2C 호환 가능</li>
                </ul>

                <div class="alert alert-warning">
                    <strong>⚠️ PCA9685 사용 시:</strong> VCC 핀에는 반드시 <strong>3.3V</strong>를 공급하여
                    내부 풀업이 3.3V를 참조하도록 해야 합니다. 5V 풀업은 Orin Nano를 손상시킵니다!
                </div>

                <h2 id="camera">카메라 인터페이스 (MIPI CSI-2)</h2>
                <p>Orin Nano의 카메라 커넥터는 기존 Nano와 다릅니다:</p>

                <table>
                    <thead>
                        <tr>
                            <th>모델</th>
                            <th>커넥터</th>
                            <th>호환성</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jetson Nano</td>
                            <td>15-pin, 1.0mm 피치</td>
                            <td>Pi Camera 직결 가능</td>
                        </tr>
                        <tr>
                            <td>Jetson Orin Nano</td>
                            <td>22-pin, 0.5mm 피치</td>
                            <td style="color: var(--accent-orange);">어댑터 케이블 필수!</td>
                        </tr>
                    </tbody>
                </table>

                <div class="alert alert-warning">
                    <strong>⚠️ 케이블 연결 시 주의:</strong>
                    <ul>
                        <li>핀 배열(Pin 1 위치)과 접점 방향(Contact side) 확인 필수</li>
                        <li>케이블을 반대로 꽂으면 카메라 미인식 또는 보드 손상 발생</li>
                        <li>서드파티 케이블 사용 시 Orin Nano 호환 여부 명시적 확인 필요</li>
                    </ul>
                </div>

                <h2 id="i2c">I2C 버스 설정</h2>
                <p>Orin Nano에서 I2C 장치 설정 시 가장 큰 혼란은 <strong>버스 번호 변경</strong>입니다:</p>

                <table>
                    <thead>
                        <tr>
                            <th>물리적 핀</th>
                            <th>Jetson Nano</th>
                            <th>Jetson Orin Nano</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Pin 3 (SDA), Pin 5 (SCL)</td>
                            <td>i2c-1</td>
                            <td class="spec-highlight">i2c-7</td>
                        </tr>
                    </tbody>
                </table>

                <h3>I2C 장치 검증</h3>
<pre><code># PCA9685 감지 확인 (Orin Nano: 버스 7번)
sudo i2cdetect -y -r 7

# 예상 출력: 0x40 (PCA9685 기본 주소) 또는 0x60, 0x70</code></pre>

                <div class="alert alert-info">
                    <strong>💡 팁:</strong> 장치가 감지되지 않으면 <code>jetson-io.py</code>를 실행하여
                    해당 핀을 SFIO(Special Function I/O) 모드로 설정해야 합니다.
                </div>

                <h2 id="bom">부품 목록 (BOM)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>카테고리</th>
                            <th>부품명</th>
                            <th>사양</th>
                            <th>수량</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td rowspan="2">메인 보드</td>
                            <td>Jetson Orin Nano Dev Kit</td>
                            <td>8GB 권장</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>NVMe SSD</td>
                            <td>256GB 이상</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td rowspan="3">전원</td>
                            <td>LiPo 배터리</td>
                            <td>3S 2200mAh 30C+</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>5V UBEC</td>
                            <td>3A~5A 출력</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>LiPo 충전기</td>
                            <td>밸런스 충전 지원</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td rowspan="2">모터 시스템</td>
                            <td>DC 기어 모터</td>
                            <td>6V~12V, 엔코더 옵션</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>모터 드라이버</td>
                            <td>PCA9685 + TB6612</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td rowspan="2">센서</td>
                            <td>RPLIDAR A1/A2</td>
                            <td>360도 2D 스캔</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>IMX219 카메라</td>
                            <td>Pi Camera v2 호환</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td rowspan="2">케이블/어댑터</td>
                            <td>CSI 어댑터 케이블</td>
                            <td>15핀 → 22핀</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>레벨 시프터</td>
                            <td>TXB0108 또는 BSS138</td>
                            <td>1</td>
                        </tr>
                    </tbody>
                </table>

                <h2 id="motor">모터 드라이버 상세</h2>
                <p>
                    Orin Nano는 40핀 헤더에서 하드웨어 PWM을 기본 제공하지 않습니다.
                    따라서 I2C 기반 PCA9685 PWM 드라이버 사용이 표준입니다.
                </p>

                <h3>PCA9685 + TB6612 연결</h3>
<pre><code># PCA9685 연결
VCC   → Jetson 3.3V (Pin 1 또는 17)
GND   → Jetson GND
SDA   → Jetson Pin 3 (I2C-7 SDA)
SCL   → Jetson Pin 5 (I2C-7 SCL)
V+    → 외부 모터 전원 (예: 12V)

# TB6612 연결
VM    → 외부 모터 전원 (배터리)
VCC   → 5V (UBEC)
GND   → 공통 접지
PWMA  → PCA9685 CH0
AIN1  → PCA9685 CH1
AIN2  → PCA9685 CH2
PWMB  → PCA9685 CH3
BIN1  → PCA9685 CH4
BIN2  → PCA9685 CH5</code></pre>

                <h2 id="lidar">LiDAR 센서 (RPLIDAR)</h2>
                <p>RPLIDAR A1/A2는 USB-to-UART 브릿지(CP210x)를 통해 데이터를 전송합니다.</p>

                <h3>Udev 규칙 설정</h3>
                <p>영구적인 장치 접근 권한과 심볼릭 링크를 위해 udev 규칙을 생성합니다:</p>

<pre><code># /etc/udev/rules.d/99-rplidar.rules 파일 생성
KERNEL=="ttyUSB*", ATTRS{idVendor}=="10c4", ATTRS{idProduct}=="ea60", \
    MODE="0666", GROUP="dialout", SYMLINK+="rplidar"

# 규칙 적용
sudo udevadm control --reload-rules
sudo udevadm trigger</code></pre>

                <div class="alert alert-success">
                    <strong>✅ 완료:</strong> 이제 LiDAR가 <code>/dev/rplidar</code>로 항상 접근 가능합니다.
                    USB 포트 번호가 바뀌어도 ROS 2 런치 파일 수정이 필요 없습니다.
                </div>

                <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                    <p style="text-align: center;">
                        <a href="software.html" class="btn btn-primary">다음: 소프트웨어 설치 →</a>
                    </p>
                </div>
            </article>
        </div>
    </main>

    <footer class="footer">
        <p>
            JetBot ROS2 Documentation &copy; 2024 |
            <a href="https://github.com/hwkim3330/jetbot-docs" target="_blank">GitHub</a>
        </p>
    </footer>
</body>
</html>
